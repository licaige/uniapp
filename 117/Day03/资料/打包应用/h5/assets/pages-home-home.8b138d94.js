import{r as e,o as t,c as i,w as s,a,F as r,b as o,n,d as l,e as d,t as c,i as u,f as h,g as m,h as f,j as p,k as g,l as _,m as b,p as w,q as y,s as C,u as k,v,S as I,x,y as B,z as T,A as q,B as D,C as j,D as H,E}from"./index.f0b840fc.js";import{_ as S}from"./_plugin-vue_export-helper.cdc0426e.js";const $=S({__name:"tab-control",props:{titles:{type:Array,default:()=>[]}},emits:["tabItemClick"],setup(m,{emit:f}){const p=e(0);return(e,g)=>{const _=u,b=h;return t(),i(b,{class:"tab-control"},{default:s((()=>[(t(!0),a(r,null,o(m.titles,((e,a)=>(t(),i(b,{key:a,class:n(["item",p.value===a?"active":""]),onClick:e=>function(e){p.value=e,f("tabItemClick",e)}(a)},{default:s((()=>[l(_,{class:"title"},{default:s((()=>[d(c(e),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})}}},[["__scopeId","data-v-0dc98ec1"]]),z=S({__name:"grid-view-item",props:{itemInfo:{type:Object,default:()=>{}}},emits:["itemClick"],setup(e,{emit:a}){const r=e;function o(){a("itemClick",r.itemInfo)}return(a,r)=>{const n=h,_=u,b=g,w=m("lazy");return t(),i(n,{class:"goods-item",onClick:o},{default:s((()=>[f(p("img",{class:"image"},null,512),[[w,e.itemInfo.show.img]]),l(n,{class:"desc-info"},{default:s((()=>[l(n,{class:"title"},{default:s((()=>[d(c(e.itemInfo.title),1)])),_:1}),l(n,{class:"info"},{default:s((()=>[l(_,{class:"price"},{default:s((()=>[d("¥"+c(e.itemInfo.price),1)])),_:1}),l(b,{class:"icon",src:"/assets/favor.347be16f.png",mode:""}),l(_,{class:"cfav"},{default:s((()=>[d(c(e.itemInfo.cfav),1)])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-229f5e0e"]]);const A=S({name:"UniGridItem",inject:["grid"],props:{index:{type:Number,default:0}},data:()=>({column:0,showBorder:!0,square:!0,highlight:!0,left:0,top:0,openNum:2,width:0,borderColor:"#e5e5e5"}),created(){this.column=this.grid.column,this.showBorder=this.grid.showBorder,this.square=this.grid.square,this.highlight=this.grid.highlight,this.top=0===this.hor?this.grid.hor:this.hor,this.left=0===this.ver?this.grid.ver:this.ver,this.borderColor=this.grid.borderColor,this.grid.children.push(this),this.width=this.grid.width},beforeDestroy(){this.grid.children.forEach(((e,t)=>{e===this&&this.grid.children.splice(t,1)}))},methods:{_onClick(){this.grid.change({detail:{index:this.index}})}}},[["render",function(e,a,r,o,d,c){const u=h;return d.width?(t(),i(u,{key:0,style:_("width:"+d.width+";"+(d.square?"height:"+d.width:"")),class:"uni-grid-item"},{default:s((()=>[l(u,{class:n([{"uni-grid-item--border":d.showBorder,"uni-grid-item--border-top":d.showBorder&&r.index<d.column,"uni-highlight":d.highlight},"uni-grid-item__box"]),style:_({"border-right-color":d.borderColor,"border-bottom-color":d.borderColor,"border-top-color":d.borderColor}),onClick:c._onClick},{default:s((()=>[b(e.$slots,"default",{},void 0,!0)])),_:3},8,["class","style","onClick"])])),_:3},8,["style"])):w("",!0)}],["__scopeId","data-v-0810a0ad"]]);const F=S({name:"UniGrid",emits:["change"],props:{column:{type:Number,default:3},showBorder:{type:Boolean,default:!0},borderColor:{type:String,default:"#D2D2D2"},square:{type:Boolean,default:!0},highlight:{type:Boolean,default:!0}},provide(){return{grid:this}},data:()=>({elId:`Uni_${Math.ceil(1e6*Math.random()).toString(36)}`,width:0}),created(){this.children=[]},mounted(){this.$nextTick((()=>{this.init()}))},methods:{init(){setTimeout((()=>{this._getSize((e=>{this.children.forEach(((t,i)=>{t.width=e}))}))}),50)},change(e){this.$emit("change",e)},_getSize(e){y().in(this).select(`#${this.elId}`).boundingClientRect().exec((t=>{this.width=parseInt((t[0].width-1)/this.column)+"px",e(this.width)}))}}},[["render",function(e,a,r,o,d,c){const u=h;return t(),i(u,{class:"uni-grid-wrap"},{default:s((()=>[l(u,{id:d.elId,ref:"uni-grid",class:n(["uni-grid",{"uni-grid--border":r.showBorder}]),style:_({"border-left-color":r.borderColor})},{default:s((()=>[b(e.$slots,"default",{},void 0,!0)])),_:3},8,["id","class","style"])])),_:3})}],["__scopeId","data-v-257e8068"]]);const G=new class{request(e,t,i){return new Promise(((s,a)=>{C({url:"http://152.136.185.210:7878/api/hy66"+e,method:t||"GET",timeout:6e4,data:i,success(e){s(e.data)},fail(e){a(e)}})}))}get(e,t){return this.request(e,"GET",t)}post(e,t){return this.request(e,"POST",params)}},L=["pop","new","sell"];function M(){let e={};return L.forEach((t=>{e[t]={page:0,list:[]}})),e}const N=k("home",{state:()=>({banners:[],recommends:[],currentType:"pop",goodsList:M()}),actions:{setCurrentType(e){this.currentType=e},async fetchHomeMultidata(){const e=await G.get("/home/multidata",{});this.banners=e.data.banner.list||[],this.recommends=e.data.recommend.list||[]},async fetchHomeData(e,t){v("log","at store/home.js:34",e,t);const i=await((e,t)=>G.get("/home/data",{type:e,page:t}))(e,t);this.goodsList[e].list.push(...i.data.list),this.goodsList[e].page=t}}}),U=S({__name:"home-banner",props:{banners:{type:Array,default:()=>[]}},emits:["bannerItemClick"],setup:(e,{emit:n})=>(d,c)=>{const u=g,h=I,m=x;return t(),i(m,{class:"banner","indicator-dots":!0,"indicator-active-color":"#ff8198",autoplay:!0,interval:3e3,duration:1e3},{default:s((()=>[(t(!0),a(r,null,o(e.banners,(e=>(t(),i(h,{key:e,onClick:t=>function(e){n("bannerItemClick",e.link)}(e)},{default:s((()=>[l(u,{class:"image",src:e.image,mode:"widthFix"},null,8,["src"])])),_:2},1032,["onClick"])))),128))])),_:1})}},[["__scopeId","data-v-8a86c882"]]),O=S({__name:"home-recommend",props:{recommends:{type:Array,default:()=>[]}},emits:["itemClick"],setup:(e,{emit:n})=>(u,m)=>{const f=g,p=h;return t(),i(p,{class:"recommend"},{default:s((()=>[(t(!0),a(r,null,o(e.recommends,(e=>(t(),i(p,{key:e,class:"recommend-item",onClick:t=>function(e){n("itemClick",e)}(e)},{default:s((()=>[l(f,{class:"image",src:e.image,mode:"widthFix"},null,8,["src"]),l(p,{class:"title"},{default:s((()=>[d(c(e.title),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})}},[["__scopeId","data-v-30e0bfc7"]]);const P=S({},[["render",function(e,a){const r=g,o=h;return t(),i(o,{class:"popular"},{default:s((()=>[l(r,{class:"image",src:"/assets/recommend_bg.6119532a.jpg",mode:"widthFix"})])),_:1})}],["__scopeId","data-v-066878f7"]]),R={__name:"home",setup(e){const n=N(),{banners:d,recommends:c,goodsList:u,currentType:m}=B(n);function f(e){j({url:"/pages/webview/webview?link="+e})}function p(e){n.setCurrentType(L[e])}function g(e){j({url:"/pages/detail/detail?iid="+e.iid})}return T((()=>{n.fetchHomeMultidata(),n.fetchHomeData("pop",1),n.fetchHomeData("new",1),n.fetchHomeData("sell",1)})),q((()=>{n.fetchHomeData(m.value,u.value[m.value].page+1)})),(e,n)=>{const _=H(E("tab-control"),$),b=H(E("grid-view-item"),z),w=H(E("uni-grid-item"),A),y=H(E("uni-grid"),F),C=h;return t(),i(C,{class:"home"},{default:s((()=>[l(U,{banners:D(d),onBannerItemClick:f},null,8,["banners"]),l(O,{recommends:D(c)},null,8,["recommends"]),l(P),l(_,{titles:["流行","新款","精选"],onTabItemClick:p}),l(y,{column:2,highlight:!1,showBorder:!1,square:!1,borderColor:"#ff8198"},{default:s((()=>[(t(!0),a(r,null,o(D(u)[D(m)].list,((e,a)=>(t(),i(w,{key:e.iid,index:a},{default:s((()=>[l(b,{itemInfo:e,onItemClick:g},null,8,["itemInfo"])])),_:2},1032,["index"])))),128))])),_:1})])),_:1})}}};export{R as default};
